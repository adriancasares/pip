---
import Banner from "../../components/Banner.astro";
import Layout from "../../layouts/Layout.astro";
import SubscribeForm from "../../components/subscribe/SubscribeForm";
import axios from "axios";
import type Newsletter from "../../types/Newsletter";

export function getStaticPaths() {
  return new Promise((resolve) => {
    axios
      .get("https://lasapip.com/api/newsletter/getNewsletterPaths")
      .then((res) => {
        resolve(
          res.data["newsletterPaths"].map((path: string) => {
            return {
              params: {
                slug: path,
              },
            };
          })
        );
      })
      .catch((err) => {
        console.log(err);
        resolve([]);
      });
  });
}

const { slug } = Astro.params;
const newsletter: Newsletter = (
  await axios.get(
    `https://lasapip.com/api/newsletter/getNewsletter?slug=${slug}`
  )
).data.newsletter;
console.log(newsletter);
---

<Layout
  title="Subscribe - Programming in Practice"
  light={true}
  og={{
    title: "The PIP Newsletter",
    description: "you join subscribe ðŸ‘€",
    image: "https://lasapip.com/icon-256.png",
    url: "https://lasapip.com/subscribe",
  }}
/>
<h1>{newsletter.name}</h1>
